---
title: 常用命令
categories: 
- JVM
---

# jstat

jstat可以查看类的加载情况，Eden、Survivor、老年代的内存使用情况，还有Young GC和Full GC的执行次数以及耗时

```
jstat -gc PID
```

找出你们的Java进程的PID，用jps命令就可以看到

接着就针对我们的Java进程执行：jstat -gc PID。这就可以看到这个Java进程的内存和GC情况了。

运行这个命令之后会看到如下列：

> S0C：这是From Survivor区的大小 
>
> S1C：这是To Survivor区的大小 
>
> S0U：这是From Survivor区当前使用的内存大小 
>
> S1U：这是To Survivor区当前使用的内存大小 
>
> EC：这是Eden区的大小 
>
> EU：这是Eden区当前使用的内存大小 
>
> OC：这是老年代的大小 OU：这是老年代当前使用的内存大小 
>
> MC：这是方法区（永久代、元数据区）的大小 
>
> MU：这是方法区（永久代、元数据区）的当前使用的内存大小 
>
> YGC：这是系统运行迄今为止的Young GC次数 
>
> YGCT：这是Young GC的耗时 FGC：这是系统运行迄今为止的Full GC次数 
>
> FGCT：这是Full GC的耗时 GCT：这是所有GC的总耗时

jstat -gccapacity PID：堆内存分析

jstat -gcnew PID：年轻代GC分析，这里的TT和MTT可以看到对象在年轻代存活的年龄和存活的最大年龄

jstat -gcnewcapacity PID：年轻代内存分析 

jstat -gcold PID：老年代GC分析 

jstat -gcoldcapacity PID：老年代内存分析 

jstat -gcmetacapacity PID：元数据区内存分析

```
jstat -gc 30149 5000
```

说明：每5 秒一次显示进程号为30149的 java进成的 GC情况

```
jstat -gc PID 180000 10
```

这就相当于是让他每隔三分钟执行一次统计，连续执行10次

# jmap

```
jmap -heap PID
```

这个信息会打印出来堆内存相关的一些参数设置，然后就是当前堆内存里的一些基本各个区域的情况

```
jmap -histo PID
```

输出对象对内存占用的情况

```
jmap -dump:live,format=b,file=dump.hprof PID
```

生成一个堆内存快照放到一个文件里去

这个命令会在当前目录下生成一个`dump.hrpof`文件，这里是二进制的格式

接着就可以使用jhat去分析堆快照了，jhat内置了web服务器，他会支持你通过浏览器来以图形化的方式分析堆转储快照

使用如下命令即可启动jhat服务器，还可以指定自己想要的http端口号，默认是7000端口号：

```
jhat dump.hprof -port 7000
```

接着你就在浏览器上访问当前这台机器的7000端口号，就可以通过图形化的方式去分析堆内存里的对象分布情况了
---
title: 常用名词
categories: 
- 消息队列
- KAFKA
---

**AR（Assigned Replicas）**：分区中的所有副本统称为AR。所有消息会先发送到leader副本，然后follower副本才能从leader中拉取消息进行同步。但是在同步期间，follower对于leader而言会有一定程度的滞后，这个时候follower和leader并非完全同步状态

**OSR（Out Sync Replicas）**：follower副本与leader副本没有完全同步或滞后的副本集合

ISR（In Sync Replicas）：AR中的一个子集，ISR中的副本都**是与leader保持完全同步的副本**，如果某个在ISR中的follower副本落后于leader副本太多，则会被从ISR中移除，否则如果完全同步，会从OSR中移至ISR集合。

在默认情况下，当leader副本发生故障时，只有在ISR集合中的follower副本才有资格被选举为新leader，而OSR中的副本没有机会（可以通过`unclean.leader.election.enable`进行配置）

**HW（High Watermark）**：高水位，它标识了一个特定的消息偏移量（offset），消费者只能拉取到这个水位 offset 之前的消息

**LEO（Log End Offset）**：标识当前日志文件中下一条待写入的消息的offset。在ISR集合中的每个副本都会维护自身的LEO，且HW==LEO

<img src="https://xiaoflyfish.oss-cn-beijing.aliyuncs.com/image/20210219154545.png" style="zoom:33%;" />

图中，HW就是8，Consumer只能拉去0~7的消息，LEO就是15，代表消息还没有同步到follower


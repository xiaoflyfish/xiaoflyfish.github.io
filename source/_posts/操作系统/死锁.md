---
title: 死锁
categories: 
- 操作系统
---

1.系统资源的竞争：系统资源的竞争导致系统资源不足，以及资源分配不当，导致死锁。

2.进程运行推进顺序不合适：进程在运行过程中，请求和释放资源的顺序不当，会导致死锁。

**四个必要条件**

互斥条件：一个资源每次只能被一个进程使用，即在一段时间内某资源仅为一个进程所占有。此时若有其他进程请求该资源，则请求进程只能等待

请求与保持条件：进程已经保持了至少一个资源，但又提出了新的资源请求时，该资源已被其他进程占有，此时请求进程被阻塞，但对自己已获得的资源保持不放 

不可剥夺条件:进程所获得的资源在未使用完毕之前，不能被其他进程强行夺走，即只能由获得该资源的进程自己来释放（只能是主动释放) 

循环等待条件: 若干进程间形成首尾相接循环等待资源的关系

这四个条件是死锁的必要条件，只要系统发生死锁，这些条件必然成立，而只要上述条件之一不满足，就不会发生死锁

**只要我们破坏其中一个，就可以成功避免死锁的发生**

其中，互斥这个条件我们没有办法破坏，因为我们用锁为的就是互斥

1. 对于占用且等待这个条件，我们可以一次性申请所有的资源，这样就不存在等待了。
2. 对于不可抢占这个条件，占用部分资源的线程进一步申请其他资源时，如果申请不到，可以主动释放它占有的资源，这样不可抢占这个条件就破坏掉了。
3. 对于循环等待这个条件，可以靠按序申请资源来预防。所谓按序申请，是指资源是有线性顺序的，申请的时候可以先申请资源序号小的，再申请资源序号大的，这样线性化后自然就不存在循环了。

# 银行家算法

**安全状态**

在避免死锁的方法中，允许进程动态地申请资源，但系统在进行资源分配之前，应先计算此次资源分配的安全性。若此次分配不会导致系统进入不安全状态，则将资源分配给进程；否则，令进程等待

因此，避免死锁的实质在于：系统在进行资源分配时，如何使系统不进入不安全状态
---
title: TCP报文头
categories: 
- 网络基础
---

![](https://xiaoflyfish.oss-cn-beijing.aliyuncs.com/image/20201207172511.png)

**端口**：两个进程在计算机内部进行通信，其中两个进程通信最基本的前提是唯一标识一个进程，通过唯一标识找到对应的进程。在本地进程通信中可以通过pid，但pid只在本地唯一。

如果把两个进程放到两台计算机通信，pid实现不了。解决这个问题的方法就是在传输层使用协议端口号，简称端口。IP地址可以唯一标识主机，TCP协议和端口号可以唯一标识主机中的一个进程，利用IP地址+协议+端口号唯一标识去标识网络中的一个进程，这种唯一标识的模式称为Socket。

源端口号和目地端口各占16位两个字节，也就是端口的范围是`2^16=65535`

另外1024以下是系统保留的，从1024-65535是用户使用的端口范围

**seq序号**：占4字节，TCP连接中传送的字节流中的每个字节都按顺序编号。例如：一段报文的序号字段值是107，携带的数据是100个字段，下一个报文段序号从107+100=207开始。

**ack确认号**：4个字节，是期望收到对方下一个报文段的第一个数据字节的序号。例如：B收到A发送的报文，其序号字段是301，数据长度是200字节，表明B正确收到A发送的到序号500为止的数据（301+200-1=500），B期望收到A下一个数据序号是501。B发送给A的确认报文段中把ack确认号置为501。

**数据偏移**：头部有可选字段，长度不固定，指出TCP报文段的数据起始处距离报文段的起始处有多远。

**保留**：保留今后使用的，被标为1。

**控制位**：由8个标志位组成。每个标志位表示一个控制功能。

其中主要的6个：

**URG紧急指针标志**，为1表示紧急指针有效，为0忽略紧急指针。

**ACK确认序号标志**，为1表示确认号有效，为0表示报文不含确认信息，忽略确认号字段。上面的确认号是否有效就是通过该标识控制的。

**PSH标志**，为1表示带有push标志的数据，指示接收方在接收到该报文段以后，应尽快将该报文段交给应用程序，而不是在缓冲区排队。

**RST重置连接标志**，重置因为主机崩溃或其他原因而出现错误的连接，或用于拒绝非法的报文段或非法的连接。

**SYN同步序号**，用于建立连接过程，在连接请求中SYN=1和ACK=0表示该数据段没有使用捎带的确认域，连接应答捎带一个确认即SYN=1和ACK=1。

**FIN终止标志**，用于释放连接，为1时表示发送方没有发送了。

**窗口**：滑动窗口大小，用来告知发送端接收端缓存大小，以此控制发送端发送数据的速率，从而达到流量控制。

**校验和**：奇偶校验，此校验和是对整个的TCP报文段（包括TCP头部和TCP数据），以16位进行计算所得，由发送端计算和存储，接收端进行验证。

**紧急指针**：只有控制位中的URG为1时才有效。指出本报文段中的紧急数据的字节数。

**选项**：其长度可变，定义其他的可选参数。
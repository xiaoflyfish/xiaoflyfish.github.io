---
title: 线程池
categories: 
- Tomcat
---

**java线程池**

如果当前运行的线程，少于corePoolSize，则创建一个新的线程来执行任务。

如果运行的线程等于或多于 corePoolSize，将任务加入 BlockingQueue。

如果 BlockingQueue 内的任务超过上限，则创建新的线程来处理任务。

如果创建的线程超出 maximumPoolSize，任务将被拒绝策略拒绝。

**tomcat线程池**

如果当前运行的线程，少于corePoolSize，则创建一个新的线程来执行任务。

如果线程数大于 corePoolSize了，Tomcat 的线程不会直接把线程加入到无界的阻塞队列中，而是去判断submittedCount（已经提交线程数）是否等于 maximumPoolSize。

如果等于，表示线程池已经满负荷运行，不能再创建线程了，直接把线程提交到队列，

如果 BlockingQueue 达到上限（假如设置了上限），被默认线程池启动拒绝策略，tomcat 线程池会 catch 住拒绝策略抛出的异常，再次把尝试任务加入中 BlockingQueue 中。

再次加入失败，启动拒绝策略。
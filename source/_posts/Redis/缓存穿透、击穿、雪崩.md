---
title: 缓存穿透、击穿、雪崩
categories: 
- Redis
---

# 缓存穿透

如果请求一个不存在的数据，每次都会去数据库查询，这种查询不存在数据的现象我们称为缓存穿透

如果每次都拿一个不存在的数据去查询数据库，可能会导致你的数据库压力增大

**解决办法**

1.缓存空值 

我们可以为这些不存在`key`在缓存中设置对应的值为`null`，后面查询这个`key`的时候就不用查询数据库了，为了健壮性，我们要对这些`key`设置过期时间，以防止真的有数据

2.BloomFilter

我们把有数据的`key`都放到`BloomFilter`中，每次查询的时候都先`去BloomFilter`判断，如果没有就直接返回null

# 缓存击穿

缓存击穿，就是说某个 `key` 非常热点，访问非常频繁，处于集中式高并发访问的情况，当这个 `key` 在失效的瞬间，大量的请求就击穿了缓存，直接请求数据库

**解决办法**

1.可将该热点数据设置为永不过期

2.采用分布式锁，只有拿到锁的第一个线程去请求数据库，然后插入缓存，当然每次拿到锁的时候都要去查询一下缓存有没有

# 缓存雪崩

当某一时刻发生大规模的缓存失效的情况

**解决办法**

1.Ehcache本地缓存+`Hystrix`限流&降级

2.设置不同的失效时间

3.采用缓存击穿的解决办法，加锁

4.永不失效，就是采用定时任务对快要失效的缓存进行更新缓存和失效时间